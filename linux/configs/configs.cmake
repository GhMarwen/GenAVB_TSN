if(NOT DEFINED CONFIG_DIR)
  message(FATAL_ERROR "CONFIG_DIR not defined")
endif()

function(system_cfg_install)
  set(target_system_cfg_file ${CMAKE_CURRENT_LIST_DIR}/${TARGET}_${CONFIG}_system.cfg)
  if(EXISTS ${target_system_cfg_file})
    install(FILES ${target_system_cfg_file} DESTINATION ${CONFIG_DIR} PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ RENAME system.cfg)
  endif()
endfunction()

function(srp_cfg_install name)
  set(target_srp_cfg_file ${CMAKE_CURRENT_LIST_DIR}/${TARGET}_${CONFIG}_srp${name}.cfg)
  if(EXISTS ${target_srp_cfg_file})
    install(FILES ${target_srp_cfg_file} DESTINATION ${CONFIG_DIR} PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ RENAME srp${name}.cfg)
  else()
    install(FILES ${CMAKE_CURRENT_LIST_DIR}/srp${name}.cfg DESTINATION ${CONFIG_DIR} PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ)
  endif()
endfunction()

if(${CONFIG} STREQUAL "endpoint_avb")
  install(DIRECTORY DESTINATION ${CONFIG_DIR})
  install(FILES ${CMAKE_CURRENT_LIST_DIR}/config_avb DESTINATION ${CONFIG_DIR} PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ RENAME config)
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "apps*.cfg")
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "genavb*.cfg")
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "fgptp.cfg*")
  srp_cfg_install("")
  system_cfg_install()
elseif(${CONFIG} STREQUAL "endpoint_tsn")
  install(DIRECTORY DESTINATION ${CONFIG_DIR})
  install(FILES ${CMAKE_CURRENT_LIST_DIR}/config_tsn DESTINATION ${CONFIG_DIR} PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ RENAME config)
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "apps-tsn*.cfg")
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "genavb-tsn*.cfg")
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "fgptp.cfg*")
  srp_cfg_install("")
  system_cfg_install()
elseif(${CONFIG} STREQUAL "endpoint_gptp_only")
  install(DIRECTORY DESTINATION ${CONFIG_DIR})
  install(FILES ${CMAKE_CURRENT_LIST_DIR}/config_tsn DESTINATION ${CONFIG_DIR} PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ RENAME config)
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "fgptp.cfg*")
  system_cfg_install()
elseif(${CONFIG} STREQUAL "bridge")
  install(DIRECTORY DESTINATION ${CONFIG_DIR})
  install(FILES ${CMAKE_CURRENT_LIST_DIR}/config_tsn DESTINATION ${CONFIG_DIR} PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ RENAME config)
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "genavb-tsn.cfg")
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "fgptp-br.cfg*")
  srp_cfg_install("-br")
  system_cfg_install()
elseif(${CONFIG} STREQUAL "hybrid")
  install(DIRECTORY DESTINATION ${CONFIG_DIR})
  install(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/ DESTINATION ${CONFIG_DIR} FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_WRITE GROUP_READ FILES_MATCHING PATTERN "fgptp-br.cfg*")
  srp_cfg_install("-br")
elseif(${CONFIG} STREQUAL "endpoint_1733")
endif()
